# QMS Platform - Quality Management System
## AI-Powered Quality Management with LangChain & Gemini

Production-ready Quality Management System with autonomous AI agents and intelligent assistants built with **LangChain** and **Google Gemini API**.

---

## ğŸš€ Features Overview

### AI Agents (Autonomous)
- **Risk Prediction Agent** - Predicts emerging risks from historical data
- **Predictive Maintenance Agent** - Schedules maintenance based on usage patterns
- **Training Gap Analysis Agent** - Identifies skill gaps and assigns training
- **Supplier Evaluation Agent** - Analyzes supplier performance and recommends actions
- **Root Cause Analysis Agent** - Applies 5 Whys & Fishbone methods

### AI Assistants (User-Facing)
- **Document Assistant** - Summarizes, extracts key points, suggests improvements
- **Sentiment Analysis Assistant** - Analyzes customer feedback and identifies trends
- **Context Analysis Assistant** - PESTEL, SWOT, and TOWS matrix generation
- **Compliance Assistant** - ISO standard compliance checking and gap analysis

### Core QMS Features
- Multi-tenant architecture with RBAC
- Advanced document management (EDMS)
- Risk & opportunity management
- Non-conformity and CAPA tracking
- Equipment maintenance scheduling
- Supplier performance management
- Training and competence tracking
- Internal/external audit management
- KPI dashboard and reporting
- CSR and whistleblowing channels

---

## ğŸ“‹ Tech Stack

**Backend Framework:**
- FastAPI 0.104.1
- Python 3.11+

**AI/ML:**
- LangChain 0.1.0
- Google Generative AI (Gemini Pro)
- LangChain-Experimental

**Database:**
- PostgreSQL 15
- SQLAlchemy ORM

**Caching & Task Queue:**
- Redis 7
- Celery (optional)

**Deployment:**
- Docker & Docker Compose
- Nginx Reverse Proxy

---

## ğŸ› ï¸ Installation & Setup

### Prerequisites
```bash
- Python 3.11+
- PostgreSQL 13+
- Redis 6+
- Docker & Docker Compose (optional)
- Gemini API Key
```

### 1. Clone Repository
```bash
git clone <repository-url>
cd qms-project
```

### 2. Create Virtual Environment
```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
# or
venv\Scripts\activate  # Windows
```

### 3. Install Dependencies
```bash
pip install -r requirements.txt
```

### 4. Configure Environment
```bash
cp .env.example .env
# Edit .env with your configuration
```

**Required Environment Variables:**
```env
GEMINI_API_KEY=your-gemini-api-key
DATABASE_URL=postgresql://user:password@localhost:5432/qms_db
REDIS_URL=redis://localhost:6379/0
SECRET_KEY=your-secret-key
```

### 5. Initialize Database
```bash
python -c "from models import Base; from database import engine; Base.metadata.create_all(bind=engine)"
```

### 6. Run Development Server
```bash
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

Visit: http://localhost:8000/docs (Swagger UI)

---

## ğŸ³ Docker Deployment

### Quick Start
```bash
# Create .env file
cp .env.example .env

# Start all services
docker-compose up -d

# View logs
docker-compose logs -f api

# Stop services
docker-compose down
```

**Services:**
- API: http://localhost:8000
- PostgreSQL: localhost:5432
- Redis: localhost:6379
- Nginx: http://localhost

---

## ğŸ“š API Endpoints

### Health & Status
```
GET  /health                    - Health check
GET  /                          - Root info
```

### AI Agents
```
POST /api/v1/agents/risk-prediction              - Run Risk Prediction Agent
POST /api/v1/agents/predictive-maintenance       - Run Predictive Maintenance Agent
POST /api/v1/agents/training-gaps                - Run Training Gap Analysis Agent
POST /api/v1/agents/supplier-evaluation          - Run Supplier Evaluation Agent
POST /api/v1/agents/root-cause-analysis          - Run Root Cause Analysis Agent
POST /api/v1/agents/run-all                      - Run all agents for org
```

### Document Assistant
```
POST /api/v1/assistant/document/summarize        - Summarize document
POST /api/v1/assistant/document/key-points       - Extract key points
POST /api/v1/assistant/document/improve          - Get improvement suggestions
```

### Sentiment Analysis Assistant
```
POST /api/v1/assistant/sentiment/analyze         - Analyze single feedback
POST /api/v1/assistant/sentiment/batch           - Batch analysis
POST /api/v1/assistant/sentiment/trends          - Identify trends
```

### Context Analysis Assistant
```
POST /api/v1/assistant/context/pestel            - PESTEL analysis
POST /api/v1/assistant/context/swot              - SWOT analysis
POST /api/v1/assistant/context/tows              - TOWS matrix
```

### Compliance Assistant
```
POST /api/v1/assistant/compliance/check          - Check ISO compliance
POST /api/v1/assistant/compliance/gaps           - Identify gaps
```

### Configuration
```
GET  /api/v1/config/iso-clauses                  - Get ISO clauses
GET  /api/v1/config/rbac                         - Get RBAC config
GET  /api/v1/config/features                     - Get features status
```

---

## ğŸ”§ Configuration

### Database Setup (PostgreSQL)
```sql
CREATE DATABASE qms_db;
CREATE USER qms_user WITH PASSWORD 'password';
ALTER ROLE qms_user SET client_encoding TO 'utf8';
ALTER ROLE qms_user SET default_transaction_isolation TO 'read committed';
GRANT ALL PRIVILEGES ON DATABASE qms_db TO qms_user;
```

### Gemini API Setup
1. Go to [Google AI Studio](https://makersuite.google.com/app/apikey)
2. Create API key
3. Add to `.env`: `GEMINI_API_KEY=your-key`

### Redis Setup
```bash
# Install Redis
brew install redis  # Mac
sudo apt-get install redis-server  # Linux

# Start Redis
redis-server
# or with Docker: docker run -d -p 6379:6379 redis:7
```

---

## ğŸ“– Usage Examples

### 1. Execute Risk Prediction Agent
```bash
curl -X POST "http://localhost:8000/api/v1/agents/risk-prediction?org_id=org_123"
```

### 2. Summarize Document
```bash
curl -X POST "http://localhost:8000/api/v1/assistant/document/summarize" \
  -H "Content-Type: application/json" \
  -d '{"content": "Your document content here...", "max_length": 200}'
```

### 3. Analyze Customer Feedback
```bash
curl -X POST "http://localhost:8000/api/v1/assistant/sentiment/analyze" \
  -H "Content-Type: application/json" \
  -d '{"feedback": "Great product but slow delivery"}'
```

### 4. Perform SWOT Analysis
```bash
curl -X POST "http://localhost:8000/api/v1/assistant/context/swot" \
  -H "Content-Type: application/json" \
  -d '{"context": "Our manufacturing company operates in emerging markets..."}'
```

### 5. Check ISO Compliance
```bash
curl -X POST "http://localhost:8000/api/v1/assistant/compliance/check" \
  -H "Content-Type: application/json" \
  -d '{"content": "Document content...", "standard": "ISO 9001"}'
```

---

## ğŸ—ï¸ Project Structure

```
qms-project/
â”œâ”€â”€ main.py                 # FastAPI application
â”œâ”€â”€ config.py              # Configuration settings
â”œâ”€â”€ models.py              # SQLAlchemy models
â”œâ”€â”€ database.py            # Database setup
â”œâ”€â”€ agents.py              # LangChain agents
â”œâ”€â”€ assistants.py          # Gemini assistants
â”œâ”€â”€ utils.py               # Utility functions
â”œâ”€â”€ requirements.txt       # Python dependencies
â”œâ”€â”€ Dockerfile             # Docker image
â”œâ”€â”€ docker-compose.yml     # Docker compose
â”œâ”€â”€ .env.example          # Environment template
â””â”€â”€ README.md             # This file
```

---

## ğŸ” Security Best Practices

1. **Environment Variables**
   - Never commit `.env` file
   - Use strong `SECRET_KEY`
   - Rotate API keys regularly

2. **Database**
   - Use strong passwords
   - Enable SSL connections
   - Regular backups

3. **API Security**
   - Implement JWT authentication
   - Rate limiting enabled
   - CORS properly configured
   - Input validation on all endpoints

4. **Deployment**
   - Use HTTPS in production
   - Keep dependencies updated
   - Regular security audits

---

## ğŸš¨ Error Handling

All endpoints return consistent error responses:

```json
{
  "status": "error",
  "message": "Error description",
  "status_code": 500,
  "timestamp": "2024-02-16T10:30:00"
}
```

---

## ğŸ“Š Monitoring & Logging

Logs are written to:
- Console (development)
- JSON formatted logs (production)
- Can be integrated with ELK, DataDog, etc.

```python
import logging
logger = logging.getLogger(__name__)
logger.info("Event occurred")
logger.error("Error description")
```

---

## ğŸ”„ Agent Execution Flow

```
1. Agent Initialization
   â”œâ”€â”€ Load Gemini LLM
   â”œâ”€â”€ Initialize Memory
   â””â”€â”€ Setup Tools

2. Data Collection
   â”œâ”€â”€ Query Database
   â”œâ”€â”€ Process Historical Data
   â””â”€â”€ Format for Analysis

3. AI Analysis
   â”œâ”€â”€ Send to Gemini
   â”œâ”€â”€ Apply Analysis Methods
   â””â”€â”€ Generate Insights

4. Result Storage
   â”œâ”€â”€ Save to Database
   â”œâ”€â”€ Generate Notifications
   â””â”€â”€ Return Response
```

---

## ğŸ§ª Testing

```bash
# Run tests
pytest

# With coverage
pytest --cov=.

# Specific test
pytest tests/test_agents.py -v
```

---

## ğŸ“ˆ Performance Optimization

- **Caching:** Redis caching for frequently accessed data
- **Async:** Async/await for non-blocking operations
- **Connection Pooling:** SQLAlchemy connection pooling
- **Indexing:** Database indexes on frequently queried columns
- **Pagination:** Limit query results

---

## ğŸ› Troubleshooting

### Port Already in Use
```bash
# Find process using port 8000
lsof -i :8000
# Kill process
kill -9 <PID>
```

### Database Connection Error
```bash
# Check PostgreSQL is running
psql -U qms_user -d qms_db -c "SELECT 1"

# Verify DATABASE_URL in .env
```

### Redis Connection Error
```bash
# Check Redis is running
redis-cli ping
# Should return: PONG
```

### Gemini API Error
```bash
# Verify API key is valid
# Check if API is enabled in Google Cloud
# Verify rate limits haven't been exceeded
```

---

## ğŸ“ Database Schema

Key tables:
- `users` - User accounts and roles
- `organizations` - Company data
- `documents` - QMS documents
- `risks` - Risk register
- `suppliers` - Vendor management
- `equipment` - Asset tracking
- `non_conformities` - CAPA tracking
- `training` - Training records
- `audits` - Audit results
- `kpis` - Performance indicators

---

## ğŸ”„ Deployment Pipeline

1. **Development** - Local development with hot reload
2. **Staging** - Test environment with production-like setup
3. **Production** - Docker containers with load balancing

```bash
# Deploy to production
docker-compose -f docker-compose.yml up -d --build

# Zero-downtime deployment
docker-compose up -d api  # Pulls new image and restarts
```

---

## ğŸ“ Support & Contributions

For issues and questions:
- Create GitHub issue
- Check existing documentation
- Review API logs

---

## ğŸ“„ License

Proprietary - All Rights Reserved

---

## ğŸ¯ Roadmap

- [ ] Multi-language support
- [ ] Advanced analytics dashboard
- [ ] Mobile app
- [ ] Blockchain audit trail
- [ ] Advanced ML models
- [ ] Integration with ERPSystems
- [ ] Custom report builder
- [ ] API webhooks
- [ ] Audit workflow automation
- [ ] Advanced role-based workflows

---

## ğŸ‘¥ Team

Built with â¤ï¸ for Quality Management

---

**Last Updated:** February 2024  
**Version:** 1.0.0  
**Status:** Production Ready âœ…